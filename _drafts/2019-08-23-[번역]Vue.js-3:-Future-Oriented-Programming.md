---
layout: post
title: "[ë²ˆì—­]Vue.js 3: Future-Oriented Programming"
author: "genie-youn"
categories: journal
tags: [vue]
image: jakub-kapusnak-Rt2t11IUizs-unsplash.jpg
---
ì´ ê¸€ì€ [Vue.js 3: Future-Oriented Programming](https://blog.bitsrc.io/vue-js-3-future-oriented-programming-54dee797988b)ë¥¼ ì›ì €ìì˜ í—ˆë½ì„ ë°›ì•„ ë²ˆì—­í•˜ì˜€ìŠµë‹ˆë‹¤.

Vue.jsì— ê´€ì‹¬ì„ ê°€ì§€ê³  ìˆë‹¤ë©´ ì•„ë§ˆ ê³§ 3ë²ˆì§¸ ë²„ì „ì´ ì¶œì‹œëœë‹¤ëŠ” ê²ƒì„ ì•Œê³  ìˆì„ê²ƒì´ë‹¤. (ë¯¸ë˜ì— ì´ ê¸€ì„ ì½ê³  ìˆë‹¤ë©´, ì´ ê¸€ì´ ì—¬ì „íˆ ìœ íš¨í•˜ê¸°ë¥¼ ë°”ë€ë‹¤. ğŸ˜‰)

í™œë°œí•˜ê²Œ ê°œë°œë˜ê³  ìˆëŠ” ìƒˆë¡œìš´ ë²„ì „ì˜ ê¸°ëŠ¥ë“¤ì€ ë‹¤ìŒ [ë ˆíŒŒì§€í† ë¦¬](https://github.com/vuejs/rfcs)ì˜ RFC(request for comments)ë¥¼ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ê·¸ ì¤‘ í•˜ë‚˜ì¸ functional-apiëŠ” Vue ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•˜ëŠ” ë°©ì‹ì— ë“œë¼ë§ˆí‹±í•œ ë³€í™”ë¥¼ ê°€ì ¸ì˜¬ê²ƒ ê°™ë‹¤.

> ì´ ê¸€ì€ JavaScriptì™€ Vueì— ê´€í•˜ì—¬ ì–´ëŠì •ë„ ì‚¬ì „ì§€ì‹ì„ ê°€ì§€ê³  ìˆë‹¤ê³  ê°€ì •í•˜ê³  ì“°ì—¬ì¡Œë‹¤.

Before we start: Use Bit to encapsulate Vue components with all their dependencies and setup. Build truly modular applications with better code reuse, simpler maintenance and less overhead. Share and collaborate on individual Vue components.

(ê´‘ê³ ) ì‹œì‘í•˜ê¸° ì „ì—, Bitì„ ì‚¬ìš©í•˜ë©´ Vue ì»´í¬ë„ŒíŠ¸ë¥¼ ì˜ì¡´í•˜ê³  ìˆëŠ” ëª¨ë“ˆë“¤ê³¼ í•¨ê»˜ ìº¡ìŠí™” í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ë” ì‰½ê²Œ ì½”ë“œë¥¼ ì¬ì‚¬ìš©í•˜ê³  ìœ ì§€ë³´ìˆ˜í•˜ë©° ë” ì ì€ ì˜¤ë²„í—¤ë“œë¥¼ ê°–ë„ë¡ ì˜ ëª¨ë“ˆí™” ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì„¤ê³„í•˜ëŠ”ê±¸ ë•ìŠµë‹ˆë‹¤. **Bitì„ ì´ìš©í•˜ì—¬ ë…ë¦½ì‘ì¸ Vue ì»´í¬ë„ŒíŠ¸ë¥¼ ê³µìœ í•˜ì—¬ í˜‘ì—…í•˜ì„¸ìš”.**

![bit](https://blog.bitsrc.io/vue-js-3-future-oriented-programming-54dee797988b)

## í˜„ì¬ APIë“¤ì˜ ë¬¸ì œ
ì´í•´ë¥¼ ë•ëŠ” ê°€ì¥ ì¢‹ì€ ë°©ë²•ì€ ì˜ˆì œë¥¼ ë³´ëŠ”ê²ƒì´ë‹ˆ, ì˜ˆì œë¥¼ ì‚´í´ë³´ë„ë¡ í•˜ì. ìœ ì €ì˜ ë°ì´í„°ë¥¼ APIë¡œ ë¶€í„° ë°›ì•„ì˜¤ê³ , ê·¸ ë™ì•ˆ ë¡œë”©ì¤‘ì´ë¼ëŠ” ìƒíƒœë¥¼ í‘œì‹œí•˜ê³  ìŠ¤í¬ë¡¤ì˜ ë†’ì´ì— ë”°ë¼ ë³€í•˜ëŠ” í—¤ë”ë¥¼ ê°€ì§„ ì»´í¬ë„ŒíŠ¸ë¥¼ êµ¬í˜„í•´ì•¼ í•œë‹¤ê³  ìƒê°í•´ë³´ì. ì•„ë§ˆ ì´ë ‡ê²Œ ìƒê¸´?

![result](https://blog.bitsrc.io/vue-js-3-future-oriented-programming-54dee797988b)

ì‹¤ì œë¡œ ë™ì‘í•˜ëŠ” ì˜ˆì œëŠ” [ì´ ê³³](https://enkot.github.io/vue-function-api-test/)ì—ì„œ ë³¼ ìˆ˜ ìˆë‹¤.

ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì¬ì‚¬ìš©ë  ìˆ˜ ìˆëŠ” ë¡œì§ì€ ì¶”ì¶œí•˜ëŠ”ê²ƒì´ ì¢‹ë‹¤. í˜„ì¬ Vue 2.xì˜ APIì—ì„œëŠ” ì˜ ì•Œë ¤ì§„ ëª‡ê°€ì§€ íŒ¨í„´ì´ ìˆë‹¤.

- ë¯¹ìŠ¤ì¸ (`mixins` ì˜µì…˜)
- ê³ ì°¨<sup>Higer-order</sup> ì»´í¬ë„ŒíŠ¸ (HOCs)

So, letâ€™s move scroll tracking logic into a mixin, and fetching logic into a higher-order component. Typical implementation with Vue you can see below.

ìŠ¤í¬ë¡¤ì˜ ìœ„ì¹˜ë¥¼ ì«“ëŠ” ë¡œì§ì€ ë¯¹ìŠ¤ì¸ìœ¼ë¡œ, ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë¡œì§ì€ ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ë¡œ ì˜®ê²¨ë³´ì. ì¼ë°˜ì ì¸ êµ¬í˜„ì€ ë‹¤ìŒê³¼ ê°™ì„ê²ƒì´ë‹¤.

Scroll Mixin:
```JavaScript
const scrollMixin = {
    data() {
        return {
            pageOffset: 0
        }
    },
    mounted() {
        window.addEventListener('scroll', this.update)
    },
    destroyed() {
        window.removeEventListener('scroll', this.update)
    },
    methods: {
        update() {
            this.pageOffset = window.pageYOffset
        }
    }
}
```

ì—¬ê¸°ì„œ ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ì— ë¦¬ìŠ¤ë„ˆë¥¼ ì¶”ê°€í•˜ê³ , í˜ì´ì§€ì˜ offsetì„ ë”°ë¼ `pageOffset`ì´ë¼ëŠ” í”„ë¡œí¼í‹°ì— ì´ ê°’ì„ ì €ì¥í•œë‹¤.

ê³ ì°¨ <sup>higer-order</sup> ì»´í¬ë„ŒíŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.

```javascript
import { fetchUserPosts } from '@/api'

const withPostsHOC = WrappedComponent => ({
    props: WrappedComponent.props,
    data() {
        return {
            postsIsLoading: false,
            fetchedPosts: []
        }
    },
    watch: {
        id: {
            handler: 'fetchPosts',
            immediate: true
        }
    },
    methods: {
        async fetchPosts() {
            this.postsIsLoading = true
            this.fetchedPosts = await fetchUserPosts(this.id)
            this.postsIsLoading = false
        }
    },
    computed: {
        postsCount() {
            return this.fetchedPosts.length
        }
    },
    render(h) {
        return h(WrappedComponent, {
            props: {
                ...this.$props,
                isLoading: this.postsIsLoading,
                posts: this.fetchedPosts,
                count: this.postsCount
            }
        })
    }
})
```

ì—¬ê¸°ì„œ `isLoading`, `posts` í”„ë¡œí¼í‹°ëŠ” ê°ê° ë¡œë”© ìƒíƒœì™€ ìœ ì €ì˜ í¬ìŠ¤íŠ¸ì— ê´€í•œ ë°ì´í„°ë¡œ ì´ˆê¸°í™”ëœë‹¤.
`fetchPosts` ë©”ì†Œë“œëŠ” ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ëœ í›„ `props.id`ì˜ ê°’ì´ ë³€ê²½ë  ë•Œ ë§ˆë‹¤ ìƒˆë¡œìš´ `id`ë¥¼ ê°€ì§„ ìœ ì €ì˜ í¬ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ í˜¸ì¶œëœë‹¤.

ìœ„ ì½”ë“œëŠ” HOCì˜ ì™„ì „í•œ êµ¬í˜„ì€ ì•„ë‹ˆì§€ë§Œ, ì´ ì˜ˆì œì—ëŠ” ì¶©ë¶„í•  ê²ƒì´ë‹¤.
ì—¬ê¸°ì„œ ìš°ë¦¬ëŠ” íŠ¹ì • ì»´í¬ë„ŒíŠ¸ë¥¼ ê°ì‹¸ì„œ ì»´í¬ë„ŒíŠ¸ì˜ í”„ë¡œí¼í‹°ì™€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ”ê²ƒê³¼ ê´€ë ¨ëœ í”„ë¡œí¼í‹°ë¥¼ í•¨ê»˜ ì „ë‹¬í•œë‹¤.

ê°ì‹¸ì§€ëŠ” ì»´í¬ë„ŒíŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```JavaScript
export default {
    name: 'PostsPage',
    mixins: [scrollMixin],
    props: {
        id: Number,
        isLoading: Boolean,
        posts: Array,
        count: Number
    }
}
```

í•´ë‹¹ í”„ë¡œí¼í‹°ì— ì ‘ê·¼í•˜ë ¤ë©´ HOCë¡œ ê°ì‹¸ì•¼ í•œë‹¤.

`const PostsPage = withPostsHOC(PostsPage)`
> í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ì˜ ì „ì²´ ì½”ë“œëŠ” [ì—¬ê¸°](https://github.com/enkot/vue-function-api-test/blob/master/src/components/PostsPageOptions.vue)ì„œ í™•ì¸í•˜ì‹œë©´ ë©ë‹ˆë‹¤.

ì´ì œ ìš°ë¦¬ëŠ” íŠ¹ì • ë¡œì§ì„ ë¯¹ìŠ¤ì¸ê³¼ ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ë¥¼ í†µí•´ êµ¬í˜„í–ˆìœ¼ë¯€ë¡œ ë‹¤ë¥¸ ê·¸ ì–´ë–¤ ì»´í¬ë„ŒíŠ¸ì—ì„œë„ ì¬ì‚¬ìš© ë  ìˆ˜ ìˆë‹¤. ğŸ¥³ ê·¸ëŸ¬ë‚˜ ëª¨ë“ ê²ƒì´ ì¥ë¯¸ë¹›ì€ ì•„ë‹ˆë‹¤. ì´ ì ‘ê·¼ë²•ë“¤ì—ëŠ” ëª‡ê°€ì§€ ë¬¸ì œê°€ ì¡´ì¬í•œë‹¤.

### 1. ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ ì¶©ëŒ âš”ï¸

`PostPage` ì»´í¬ë„ŒíŠ¸ì— `update` ë¼ëŠ” ë©”ì†Œë“œë¥¼ ì¶”ê°€í•´ì•¼í•œë‹¤ê³  ìƒê°í•´ë³´ì.
```JavaScript
export default {
    name: 'PostsPage',
    mixins: [scrollMixin],
    props: {
        id: Number,
        isLoading: Boolean,
        posts: Array,
        count: Number
    },
    methods: {
        update() {
            console.log('some update logic here')
        }
    }
}
```

If you open the page again and scroll it, the topbar will not be shown anymore. This is due to the overwriting of mixinâ€™s method update. The same works for HOCs. If you change the data field fetchedPosts to posts:

í˜ì´ì§€ë¥¼ ë‹¤ì‹œ ì—´ê³  ìŠ¤í¬ë¡¤ì„ í•˜ê²Œ ë˜ë©´, ìƒë‹¨ ì˜ì—­ì€ ë” ì´ìƒ ë³´ì—¬ì§€ì§€ ì•ŠëŠ”ë‹¤. ìš°ë¦¬ê°€ ì¶”ê°€í•œ ë©”ì†Œë“œê°€ ë¯¹ìŠ¤ì¸ì˜ `update` ë©”ì†Œë“œë¥¼ ë®ì–´ì“°ê¸° ë•Œë¬¸ì´ë‹¤.

ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ì—ì„œë„ ë§ˆì°¬ê°€ì§€ì´ë‹¤. ë§Œì•½ `data`ì˜ `fetchedPosts`ë¥¼ `posts`ë¡œ ë³€ê²½í•˜ê²Œ ë˜ë©´ ë¬¸ì œê°€ ë°œìƒí•˜ê²Œ ëœë‹¤.


```JavaScript
const withPostsHOC = WrappedComponent => ({
    props: WrappedComponent.props, // ['posts', ...]
    data() {
        return {
            postsIsLoading: false,
            posts: [] // fetchedPosts -> posts
        }
    },
```

ì•„ë§ˆ ì´ëŸ° ì—ëŸ¬ë¥¼ ë³´ê²Œ ë  ê²ƒì´ë‹¤.
